<div class="hbox hbox-auto-xs hbox-auto-sm">
  <div class="bg-light lter b-b wrapper-md ng-scope clear">
    <h1 class="pull-left m-n font-thin h3" >{{project.name}} - Gantt Chart</h1>
    <button  class="btn btn-primary pull-right m-l">Save</button>
    <button  onclick="updateCriticalPath(this)" class="btn btn-info pull-right m-l">Show Critical Path</button>
    <button  onclick="goToToday(this)" class="btn btn-info pull-right m-l">Today</button>
  </div>
  <section class=" col-xs-12 ng-scope">
    <div class="wrapper b-b">

      <style type="text/css">
        html, body{ height:100%; padding:0px; margin:0px; overflow: hidden;}
        .gantt_task_cell.week_end{
          background-color: #EFF5FD;
        }
        .gantt_selected .gantt_task_cell.week_end{
          background-color: #f0e493;
        }
      </style>
      <div style="text-align: center;" class="m-b">
      </div>
      <div id="gantt_here" style='width:100%; height:600px;' ng-show="gantt_data.data.length > 0">
      </div>
      <div class="loading-gantt" ng-show="gantt_data.data.length == 0">
        <span>Loading Gantt Chart</span>
      </div>
      <script type="text/javascript">
        var gantt_data;

        function updateCriticalPath(toggle){
          toggle.enabled = !toggle.enabled;
          if(toggle.enabled){
            toggle.innerHTML = "Hide Critical Path";
            gantt.config.highlight_critical_path = true;
          }else{
            toggle.innerHTML = "Show Critical Path";
            gantt.config.highlight_critical_path = false;
          }
          gantt.render();
        }

        gantt.config.buttons_left=["dhx_save_btn","dhx_cancel_btn","details_btn"];
        gantt.locale.labels["details_btn"] = "Full Details";

        gantt.attachEvent("onLightboxButton", function(button_id, node, e){
          if(button_id == "details_btn"){
            var id = gantt.getState().lightbox;
            console.log('id',id);
            window.location.href="#/app/page/nodes/"+id;
            gantt.hideLightbox();
          }
        });

        //excludes overtaking the target task by the source task
        //in case of creating "finish_to_start" links
        gantt.attachEvent("onBeforeLinkAdd", function(id, link){
          if (link.type == 0){
              var sourceTask = gantt.getTask(link.source);
              var targetTask = gantt.getTask(link.target);
              if (sourceTask.type === "project" || targetTask.type === "project"){
                  alert("Can't link a folder")
                  return false;
              }
          }
        });

        function goToToday(){
          $(".gantt_task").animate({ scrollLeft: $(".gantt_marker.today").position().left-200}, 1000)
        }

        var date_to_str = gantt.date.date_to_str(gantt.config.task_date);

        var id = gantt.addMarker({ start_date: new Date(), css: "today", title:date_to_str( new Date())});
        setInterval(function(){
            var today = gantt.getMarker(id);
            today.start_date = new Date();
            today.title = date_to_str(today.start_date);
            gantt.updateMarker(id);
        }, 1000*60);
          //also possible
          /*gantt.templates.task_class = function(start, end, task){
           if(gantt.isCriticalTask(task))
           return "critical_task";
           return "";
           };

           gantt.templates.link_class = function(link){
           if(gantt.isCriticalLink(link))
           return "critical_link";
           return "";
         };*/
         var demo_tasks = {
          data: [
          ],
          links: [
          ]
        };

        gantt.config.work_time = true;
        gantt.config.details_on_create = false;
        gantt.config.scale_unit = "month";
        gantt.config.duration_unit = "day";
        gantt.config.row_height = 30;
        gantt.config.min_column_width = 40;
        gantt.config.step = 1;

        gantt.init("gantt_here");
        gantt.templates.task_cell_class = function(task, date){
          if(!gantt.isWorkTime(date))
            return "week_end";
          return "";
        };

        gantt.parse(demo_tasks);
      </script>
    </div>
  </section>
</div>